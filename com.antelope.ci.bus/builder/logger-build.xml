<?xml version="1.0" encoding="UTF-8"?>
<project name="ant build for logger" basedir="." default="build">
	<property file="build.properties" />

	<target name="build" depends="init, depends, compile, common.compile, bus.compile">
	
		<copy todir="${app.logger.lib}">
			<fileset dir="${target.depends}">
				<include name="org.apache.felix.framework-*.jar" />
			</fileset>
		</copy>
		
		<copy todir="${app.logger.system}">
			<fileset dir="${target.depends}">
				<include name="org.apache.felix.bundlerepository--*.jar" />
				<include name="org.apache.felix.gogo*.jar" />
				<include name="log4j*.jar" />
			</fileset>
		</copy>
		
		<copy todir="${app.logger.etc}">
			<fileset dir="${prj.bus.etc}" />
		</copy>
		
		<copy file="${script.start}" todir="${app.logger.bin}" />
	</target>


	<target name="common.compile">
		<exec executable="mvn">
			<arg line="-f ${prj.common.pom}" />
			<arg line="install" />
		</exec>
		<copy file="${prj.common.jar}" todir="${app.logger.lib}" />
	</target>

	<target name="bus.compile">
		<exec executable="mvn">
			<arg line="-f ${prj.bus.pom}" />
			<arg line="install" />
		</exec>
		<copy file="${prj.bus.jar}" todir="${app.logger.lib}" />
	</target>

	<target name="compile">
		<exec executable="mvn">
			<arg line="-f ${prj.logger.pom}" />
			<arg line="install" />
		</exec>
		<copy file="${prj.logger.jar}" todir="${app.logger.system.ext}" />
	</target>

	<target name="depends">
		<exec executable="mvn">
			<arg line="-f ${mvn.logger.depends}" />
			<arg line="dependency:copy-dependencies" />
			<arg value="-DexcludeGroupIds=junit" />
		</exec>
	</target>

	<target name="init" depends="clean">
		<mkdir dir="${app.logger.root}" />
		<mkdir dir="${app.logger.bin}" />
		<mkdir dir="${app.logger.etc}" />
		<mkdir dir="${app.logger.system}" />
		<mkdir dir="${app.logger.system.ext}" />
		<mkdir dir="${app.logger.lib}" />
		<mkdir dir="${app.logger.lib.ext}" />
		<mkdir dir="${app.logger.plugin}" />
		<mkdir dir="${src.logger.root}" />
	</target>

	<target name="clean">
		<delete dir="${app.logger.root}" />
		<delete dir="${src.logger.root}" />
		<delete dir="${target.root}" />
	</target>
</project>